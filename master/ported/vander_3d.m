% Thu Jul 12 16:29:58 MSK 2012
% Karl KÃ¤stner, Berlin

% attention : order of mixed powers different from 2D!
% in x : col1 : x, col 2: y, col 3: z
% out  : columns
% 1 x y z x^2 y^2 z^2 xy xz yz
function V = vander_3d(x,n)
	switch (n)
		case (0) % constant
			V = ones(size(x,1),1);
		case (1) % linear
			V = [ones(size(x,1),1) x];
		case (2) % quadratic
			V = [ones(size(x,1),1) x x.^2 x(:,1).*x(:,2) x(:,1).*x(:,3) x(:,2).*x(:,3)];
		case {3} % cubic
			V = [ones(size(x,1),1) x x.^2 x(:,1).*x(:,2) x(:,1).*x(:,3) x(:,2).*x(:,3) ...
				x.^3 ...
				x(:,1).^2.*x(:,2) x(:,1).^2.*x(:,3) ...
				x(:,2).^2.*x(:,1) x(:,2).^2.*x(:,3) ...
				x(:,3).^2.*x(:,1) x(:,3).^2.*x(:,2) ...
				x(:,1).*x(:,2).*x(:,3) ];
		case {4} % quartic
			V = [ones(size(x,1),1) x x.^2 x(:,1).*x(:,2) x(:,1).*x(:,3) x(:,2).*x(:,3) ...
				x.^3 ...
				x(:,1).^2.*x(:,2) x(:,1).^2.*x(:,3) ...
				x(:,2).^2.*x(:,1) x(:,2).^2.*x(:,3) ...
				x(:,3).^2.*x(:,1) x(:,3).^2.*x(:,2) ...
				x(:,1).*x(:,2).*x(:,3) ...
				x.^4 ...
				x(:,1).^3.*x(:,2) x(:,1).^3.*x(:,3) ...
				x(:,2).^3.*x(:,1) x(:,2).^3.*x(:,3) ...
				x(:,3).^3.*x(:,1) x(:,3).^3.*x(:,2) ...
				x(:,1).^2.*x(:,2).^2 x(:,1).^2.*x(:,3).^2 x(:,2).^2.*x(:,3).^2 ...
				x(:,1).^2.*x(:,2).*x(:,3) x(:,2).^2.*x(:,1).*x(:,3) x(:,3).^2.*x(:,1).*x(:,2) ];
		otherwise
			error('vander_3d','degree of polynomial not yet supported');
	end
end

