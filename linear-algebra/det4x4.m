% Thu 11 Jan 10:52:01 CET 2018
%
%% determinant of stacked 4x4 matrices
function det = det4x4(A)
	det = [   A(1,1,:).*A(2,2,:).*A(3,3,:).*A(4,4,:) ...
		- A(1,1,:).*A(2,2,:).*A(3,4,:).*A(4,3,:) ...
		- A(1,1,:).*A(2,3,:).*A(3,2,:).*A(4,4,:) ...
		+ A(1,1,:).*A(2,3,:).*A(3,4,:).*A(4,2,:) ...
		+ A(1,1,:).*A(2,4,:).*A(3,2,:).*A(4,3,:) ...
		- A(1,1,:).*A(2,4,:).*A(3,3,:).*A(4,2,:) ...
		- A(1,2,:).*A(2,1,:).*A(3,3,:).*A(4,4,:) ...
		+ A(1,2,:).*A(2,1,:).*A(3,4,:).*A(4,3,:) ...
		+ A(1,2,:).*A(2,3,:).*A(3,1,:).*A(4,4,:) ...
		- A(1,2,:).*A(2,3,:).*A(3,4,:).*A(4,1,:) ...
		- A(1,2,:).*A(2,4,:).*A(3,1,:).*A(4,3,:) ...
		+ A(1,2,:).*A(2,4,:).*A(3,3,:).*A(4,1,:) ...
		+ A(1,3,:).*A(2,1,:).*A(3,2,:).*A(4,4,:) ...
		- A(1,3,:).*A(2,1,:).*A(3,4,:).*A(4,2,:) ...
		- A(1,3,:).*A(2,2,:).*A(3,1,:).*A(4,4,:) ...
		+ A(1,3,:).*A(2,2,:).*A(3,4,:).*A(4,1,:) ...
		+ A(1,3,:).*A(2,4,:).*A(3,1,:).*A(4,2,:) ...
		- A(1,3,:).*A(2,4,:).*A(3,2,:).*A(4,1,:) ...
		- A(1,4,:).*A(2,1,:).*A(3,2,:).*A(4,3,:) ...
		+ A(1,4,:).*A(2,1,:).*A(3,3,:).*A(4,2,:) ...
		+ A(1,4,:).*A(2,2,:).*A(3,1,:).*A(4,3,:) ...
		- A(1,4,:).*A(2,2,:).*A(3,3,:).*A(4,1,:) ...
		- A(1,4,:).*A(2,3,:).*A(3,1,:).*A(4,2,:) ...
		+ A(1,4,:).*A(2,3,:).*A(3,2,:).*A(4,1,:)];
end

