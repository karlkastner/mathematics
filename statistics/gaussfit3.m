% Tue 24 Dec 12:10:01 +08 2019
function [a,b,c]=gaussfit3(x,f)
	if (isvector(f))
		f=rvec(f);
	end
	if (isvector(x))
		x=rvec(x);
	end
	% f = a/(c sqrt(2 pi))*exp(-(x-b)^2/(2*c^2)
	% syms f1 f2 f3 x1 x2 x3 a b c2; s=solve(log(f1) == log(a) - (x1-b)^2/(2*c2),  log(f2) == log(a) - (x2-b)^2/(2*c2), log(f3) == log(a) - (x3-b)^2/(2*c2), [a,b,c2])
	b = (       x(:,1).^2.*log(f(:,1)./f(:,2)) ...
	          - x(:,1).^2.*log(f(:,1)./f(:,3)) ...
	          + x(:,2).^2.*log(f(:,1)./f(:,3)) ...
	          - x(:,3).^2.*log(f(:,1)./f(:,2))) ...
	   ./ (2*(  x(:,1).*log(f(:,1)./f(:,2)) ...
                  - x(:,1).*log(f(:,1)./f(:,3)) ...
	          + x(:,2).*log(f(:,1)./f(:,3)) ...
	          - x(:,3).*log(f(:,1)./f(:,2))));
	c2 =(   - x(:,1).^2.*x(:,2)  ...
		+ x(:,1).^2.*x(:,3)  ...
		+ x(:,1).*x(:,2).^2  ...
		- x(:,1).*x(:,3).^2  ...
		- x(:,2).^2.*x(:,3)  ...
		+ x(:,2).*x(:,3).^2)  ...
		./(   2*x(:,1).*log(f(:,1)./f(:,2))  ...
		    - 2*x(:,1).*log(f(:,1)./f(:,3))  ...
		    + 2*x(:,2).*log(f(:,1)./f(:,3))  ...
		    - 2*x(:,3).*log(f(:,1)./f(:,2))); 
	a  = f(:,1).*exp((x(:,1)-b).^2./(2*c2));
	c  = sqrt(c2);
	a  = a.*c*sqrt(2*pi);
end

